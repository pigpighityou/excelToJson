# excel-json

# 功能：识别传入文件或文件夹里的表格文件，输入后端服务器，进行解析加工，返回 json 数据，最后再将 json 数据打包压缩返回给前端用户

## 别忘了打开package.json安装依赖 dependencies里的全部都通过 yarn add xx的形式安装一遍，例如 "archiver": "^7.0.1", 那就是 yarn add archiver。不过在此之前 得要先下一个 yarn 依赖包 

## 项目服务器部署在http://127.0.0.1:7002

## 这个项目没用 npm 用的是 yarn 所以启动服务器的时候用 yarn start

## 两个有效的接口是： http://127.0.0.1:7002/upload-dir 和 http://127.0.0.1:7002/upload 可以实现用户友好性操作，然后由于很用户友好，就没必要讲了

## 在http://127.0.0.1:7002/upload-dir里千万不要传内容过大的文件夹，诸如包含图片 视频的文件 最好 传的一个文件夹，里面的格式只有[".pdf", ".json", ".log", "xlsx", "xls", "csv",'docx','doc','png','webp','jpg']等，然后会帮你自动识别里面的表格 从而进行转换json。

# 具体转换json的格式要求可以见 app/extend/application.js 里的 trans 函数 到达文件对应路径，ctrl+f 输入 trans，让系统帮你定位就可以，具体看注释

## 如果拖动文件夹等方式上传文件加载后的结果未达预期，可以试着手动传输。如果遇到 bug，就刷新。

## 还有进一步完善的空间。很多不完善的地方，例如 非表格文件前端点击下载交互，也是可以下载一个空的压缩文件，这是不合理的；转换死板，需要引入一个用户友好的前端配置相关参数的功能，从而契合每个人在表格文件转换为json格式上不同的要求等等。项目初步具备自动化将 excel 转换为 json 的功能，但是诸如架构，url 的结构设计，以及代码的优化等等都还没有完成，所以这个项目还是一个半成品，但是可以用来实现转换功能
